restaurant_dimensions={width:1800,height:1400},restaurant_tables=[{x:92,y:41,width:120,height:70,seats:2,area:0},{x:260,y:41,width:120,height:70,seats:2,area:0},{x:428,y:41,width:120,height:70,seats:2,area:0},{x:596,y:41,width:120,height:70,seats:2,area:0},{x:47,y:202,width:70,height:120,seats:2,area:0},{x:47,y:402,width:70,height:120,seats:2,area:0},{x:47,y:602,width:70,height:120,seats:2,area:0},{x:404,y:757,width:120,height:70,seats:2,area:0},{x:590,y:757,width:120,height:70,seats:2,area:0},{x:363,y:367,width:150,height:120,seats:4,area:0},{x:363,y:567,width:150,height:120,seats:4,area:0},{x:609,y:367,width:150,height:120,seats:4,area:0},{x:609,y:567,width:150,height:120,seats:4,area:0},{x:41,y:958,width:70,height:120,seats:2,area:1},{x:41,y:1158,width:70,height:120,seats:2,area:1},{x:324,y:958,width:70,height:120,seats:2,area:1},{x:324,y:1158,width:70,height:120,seats:2,area:1},{x:548,y:920,width:120,height:150,seats:4,area:1},{x:818,y:920,width:120,height:150,seats:4,area:1},{x:548,y:1160,width:120,height:150,seats:4,area:1},{x:818,y:1160,width:120,height:150,seats:4,area:1},{x:1056,y:958,width:70,height:120,seats:2,area:1},{x:1056,y:1158,width:70,height:120,seats:2,area:1},{x:1471,y:920,width:120,height:150,seats:4,area:1},{x:1471,y:1160,width:120,height:150,seats:4,area:1},{x:766,y:367,width:150,height:120,seats:4,area:2},{x:766,y:567,width:150,height:120,seats:4,area:2},{x:1012,y:367,width:150,height:120,seats:4,area:2},{x:1012,y:567,width:150,height:120,seats:4,area:2},{x:1356,y:367,width:150,height:120,seats:4,area:2},{x:1356,y:567,width:150,height:120,seats:4,area:2},{x:1602,y:367,width:150,height:120,seats:4,area:2},{x:1602,y:567,width:150,height:120,seats:4,area:2},{x:831,y:757,width:120,height:70,seats:2,area:2},{x:1017,y:757,width:120,height:70,seats:2,area:2},{x:1381,y:757,width:120,height:70,seats:2,area:2},{x:1567,y:757,width:120,height:70,seats:2,area:2}];var tsOccupiedTableIDs=[],tsSelectedTableIDs=[],tsHoveredTableID=-1,tsCanvas=document.getElementById("table-selection-canvas"),tsImgObj=new Image;function getCanvasMouseCoords(e,t){var a=tsCanvas.getBoundingClientRect();return{x:(e-(a.left+window.pageXOffset))/a.width,y:(t-(a.top+window.pageYOffset))/a.height}}function getClosestAvailableTableID(e,t){e*=restaurant_dimensions.width,t*=restaurant_dimensions.height;var a,s=-1;for(let h=0;h<restaurant_tables.length;h++){if(-1!=tsOccupiedTableIDs.indexOf(h))continue;let i=restaurant_tables[h],r=0;e<i.x?r=i.x-e:e>i.x+i.width&&(r=e-(i.x+i.width));let l=0;t<i.y?l=i.y-t:t>i.y+i.height&&(l=t-(i.y+i.height));let d=r*r+l*l;(-1==s||d<a)&&(s=h,a=d)}return s}function drawTableSelectionCanvas(){var e=tsCanvas.getContext("2d");e.drawImage(tsImgObj,0,0,tsImgObj.width,tsImgObj.height);var t=Math.sqrt(tsImgObj.width*tsImgObj.width+tsImgObj.height*tsImgObj.height),a=.005*t;e.lineWidth=.005*t;var s=tsImgObj.width/restaurant_dimensions.width,h=tsImgObj.height/restaurant_dimensions.height;for(let t=0;t<tsOccupiedTableIDs.length;t++){let i=restaurant_tables[tsOccupiedTableIDs[t]],r=(i.x-a)*s,l=(i.y-a)*h,d=(i.width+2*a)*s,g=(i.height+2*a)*h;e.fillStyle="rgba(255, 0, 0, 0.1)",e.fillRect(r,l,d,g),e.strokeStyle="rgba(255, 0, 0, 0.6)",e.strokeRect(r,l,d,g),e.beginPath(),e.moveTo(r,l),e.lineTo(r+d,l+g),e.moveTo(r,l+g),e.lineTo(r+d,l),e.closePath(),e.stroke()}for(let t=0;t<tsSelectedTableIDs.length;t++){let i=((r=restaurant_tables[tsSelectedTableIDs[t]]).x-a)*s,l=(r.y-a)*h,d=(r.width+2*a)*s,g=(r.height+2*a)*h;e.fillStyle="rgba(0, 255, 0, 0.15)",e.fillRect(i,l,d,g),e.strokeStyle="rgba(0, 255, 0, 0.8)",e.strokeRect(i,l,d,g)}let i=-1==tsOccupiedTableIDs.indexOf(tsHoveredTableID);if(-1!=tsHoveredTableID&&i){var r;let t=((r=restaurant_tables[tsHoveredTableID]).x-a)*s,i=(r.y-a)*h,l=(r.width+2*a)*s,d=(r.height+2*a)*h;e.fillStyle="rgba(0, 114, 76, 0.15)",e.fillRect(t,i,l,d),e.strokeStyle="rgba(0, 114, 76, 0.8)",e.strokeRect(t,i,l,d)}}tsImgObj.onload=function(){tsCanvas.width=tsImgObj.width,tsCanvas.height=tsImgObj.height;for(let e=0;e<restaurant_tables.length;e++)Math.random()<.5&&tsOccupiedTableIDs.push(e);drawTableSelectionCanvas()},tsImgObj.src="./restaurant.png",tsCanvas.addEventListener("click",(function(e){let t=getCanvasMouseCoords(e.pageX,e.pageY),a=getClosestAvailableTableID(t.x,t.y);if(-1!=a){let e=tsSelectedTableIDs.indexOf(a);-1==e?tsSelectedTableIDs.push(a):tsSelectedTableIDs.splice(e,1);let t=0;for(let e=0;e<tsSelectedTableIDs.length;e++)t+=restaurant_tables[tsSelectedTableIDs[e]].seats;selectTables(tsSelectedTableIDs,t)}drawTableSelectionCanvas()})),tsCanvas.addEventListener("mousemove",(function(e){var t=getCanvasMouseCoords(e.pageX,e.pageY);tsHoveredTableID=getClosestAvailableTableID(t.x,t.y),drawTableSelectionCanvas()})),tsCanvas.addEventListener("mouseleave",(function(){tsHoveredTableID=-1,drawTableSelectionCanvas()}));